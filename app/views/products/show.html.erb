<div class="container my-5">
  <div class="row g-5">
    <div class="col-lg-6">
      <% if @product.photo_urls.present? && @product.photo_urls.any? %>
        <div class="carousel slide shadow" id="productCarousel-<%= @product.id %>" data-bs-ride="carousel">
          <div class="carousel-inner rounded">
            <% @product.photo_urls.each_with_index do |url, index| %>
              <div class="carousel-item <%= 'active' if index.zero? %>">
                <%= image_tag url,
                              class: "d-block w-100",
                              style: "height: 520px; object-fit: contain; background: #f8f9fa;",
                              alt: "#{@product.name} - фото #{index + 1}" %>
              </div>
            <% end %>
          </div>

          <% if @product.photo_urls.size > 1 %>
            <button class="carousel-control-prev" type="button" data-bs-target="#productCarousel-<%= @product.id %>" data-bs-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Попереднє</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#productCarousel-<%= @product.id %>" data-bs-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="visually-hidden">Наступне</span>
            </button>

            <!-- Точки-індикатори -->
            <div class="carousel-indicators position-absolute bottom-0 start-50 translate-middle-x">
              <% @product.photo_urls.each_with_index do |_, index| %>
                <button type="button"
                        data-bs-target="#productCarousel-<%= @product.id %>"
                        data-bs-slide-to="<%= index %>"
                        class="<%= 'active' if index.zero? %>"
                        aria-current="<%= 'true' if index.zero? %>"
                        aria-label="Слайд <%= index + 1 %>"></button>
              <% end %>
            </div>
          <% end %>
        </div>
      <% else %>
        <div class="bg-light rounded d-flex align-items-center justify-content-center border" style="height: 520px;">
          <span class="text-muted fs-4">Фото відсутні</span>
        </div>
      <% end %>
    </div>

    <div class="col-lg-6">
      <h1 class="display-5 fw-bold mb-3"><%= @product.name %></h1>
      <p class="lead text-muted mb-4"><%= @product.brand %></p>

      <div class="fs-1 text-primary fw-bold mb-4">
        <%= number_to_currency(@product.price, unit: "₴", precision: 0) %>
      </div>

      <hr class="my-4">

      <h4 class="mb-3">Опис товару</h4>
      <div class="lead mb-5"><%= simple_format(@product.description) %></div>

      <hr class="my-4">

      <h5 class="mb-3">Доступні розміри:</h5>
      <div class="d-flex flex-wrap gap-2 mb-5">
        <% @product.sizes.each do |size| %>
          <span class="badge bg-dark fs-6 px-4 py-2"><%= size.eu_size %></span>
        <% end %>
      </div>

      <% unless current_user&.admin? %>
        <%= form_with url: add_to_cart_path, class: "d-flex align-items-center gap-3 mb-4" do |f| %>
          <%= f.hidden_field :product_id, value: @product.id %>
          <%= f.select :size,
                       options_for_select(@product.sizes.map { |s| [s.eu_size, s.eu_size] }),
                       {},
                       class: "form-select w-auto" %>
          <%= f.submit "В кошик", class: "btn btn-success btn-lg px-5" %>
        <% end %>
      <% end %>

      <div class="mt-5">
        <%= link_to "Назад до каталогу", root_path, class: "btn btn-outline-secondary btn-lg" %>

        <% if current_user&.admin? %>
          <%= link_to "Редагувати товар", edit_product_path(@product), class: "btn btn-warning btn-lg ms-3" %>
          <%= button_to "Видалити товар", @product,
                        method: :delete,
                        data: { turbo_confirm: "Точно видалити «#{@product.name}»?" },
                        class: "btn btn-danger btn-lg ms-3" %>
        <% end %>
      </div>
    </div>
  </div>
</div>